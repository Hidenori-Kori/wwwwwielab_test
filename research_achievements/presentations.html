<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å­¦ä¼šç™ºè¡¨ | é­ç ”ç©¶å®¤</title>
    <link rel="stylesheet" href="../Base/style.css"> 
</head>
<body>

    <div id="header-placeholder"></div>

    <section class="hero" style="height: 40vh;">
        <div class="hero-overlay"></div>
        <div class="container hero-content">
            <h1>å­¦ä¼šç™ºè¡¨</h1>
            <h3>Presentations</h3>
        </div>
    </section>

    <section class="presentation-list">
        <div class="container">
            <h2 class="section-title">Conference Papers</h2>
            <div id="presentation-list-wrapper">
                <p style="text-align: center; color: #888;">Loading data...</p>
            </div>
        </div>
    </section>
    
    <div id="footer-placeholder"></div>

    <script src="../include.js"></script>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            loadComponent('header-placeholder', '../header.html');
            loadComponent('footer-placeholder', '../footer.html');
            
            // CSVãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿
            loadPresentationsData();
        });

        async function loadPresentationsData() {
            try {
                // ã‚­ãƒ£ãƒƒã‚·ãƒ¥å›é¿ã®ãŸã‚ã«ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ã‚’ä»˜ä¸ï¼ˆæ›´æ–°ãŒåæ˜ ã•ã‚Œã‚„ã™ãã™ã‚‹ï¼‰
                const response = await fetch('../csv/presentations_data.csv?v=' + new Date().getTime());
                
                if (!response.ok) throw new Error("CSV file not found");
                const text = await response.text();

                // CSVãƒ‘ãƒ¼ã‚¹ (1è¡Œç›®ã¯ãƒ˜ãƒƒãƒ€ãƒ¼ãªã®ã§å‰Šé™¤)
                const rows = text.trim().split('\n').slice(1);

                const wrapper = document.getElementById('presentation-list-wrapper');
                wrapper.innerHTML = ''; // Loadingè¡¨ç¤ºã‚’æ¶ˆã™

                rows.forEach(row => {
                    // ã‚«ãƒ³ãƒåŒºåˆ‡ã‚Šï¼ˆç°¡æ˜“å®Ÿè£…ï¼šãƒ‡ãƒ¼ã‚¿å†…ã«ã‚«ãƒ³ãƒã‚’å«ã‚ãªã„å‰æï¼‰
                    const cols = row.split(',');
                    if (cols.length < 4) return;

                    const date = cols[0];
                    const title = cols[1];
                    const conference = cols[2];
                    const authors = cols[3];
                    const link = cols[4] ? cols[4].trim() : "";

                    // ãƒªãƒ³ã‚¯ãŒã‚ã‚‹å ´åˆã¯ <a>ã€ãªã‘ã‚Œã° <div>
                    const cardTag = link ? 'a' : 'div';
                    const hrefAttr = link ? `href="${link}" target="_blank"` : '';
                    const linkClass = link ? 'has-link' : '';
                    const linkIcon = link ? '<span class="external-link-icon">ğŸ”— Link</span>' : '';

                    const card = document.createElement(cardTag);
                    card.className = `presentation-card ${linkClass}`;
                    if(link) {
                        card.setAttribute('href', link);
                        card.setAttribute('target', '_blank');
                    }

                    card.innerHTML = `
                        <div class="presentation-date">${date}</div>
                        <h3 class="presentation-title">
                            ${title}
                            ${linkIcon}
                        </h3>
                        <div class="presentation-meta">
                            <span class="meta-label">Conference</span>
                            <span>${conference}</span>
                        </div>
                        <div class="presentation-meta">
                            <span class="meta-label">Authors</span>
                            <span>${authors}</span>
                        </div>
                    `;
                    wrapper.appendChild(card);
                });

            } catch (error) {
                console.error("Presentations Error:", error);
                document.getElementById('presentation-list-wrapper').innerHTML = 
                    '<p style="text-align:center;">ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸã€‚</p>';
            }
        }
    </script>
</body>
</html>