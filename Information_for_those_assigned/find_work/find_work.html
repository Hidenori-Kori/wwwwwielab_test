<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å’æ¥­å¾Œã®é€²è·¯ | é­ç ”ç©¶å®¤</title>
    <link rel="stylesheet" href="../../Base/style.css"> 
</head>
<body class="theme-green">

    <div id="header-placeholder"></div>

    <section class="hero" style="height: 40vh;">
        <div class="hero-overlay"></div>
        <div class="container hero-content">
            <h1>å’æ¥­å¾Œã®é€²è·¯</h1>
            <h3>Career Paths</h3>
        </div>
    </section>

    <section>
        <div class="container">
            <p>é­ç ”ç©¶å®¤ã®å’æ¥­ç”Ÿã¯ã€ãƒ‘ãƒ¯ãƒ¼ã‚¨ãƒ¬ã‚¯ãƒˆãƒ­ãƒ‹ã‚¯ã‚¹ã€å›è·¯è¨­è¨ˆã€æƒ…å ±é€šä¿¡ãªã©å¤šå²ã«ã‚ãŸã‚‹åˆ†é‡ã§æ´»èºã—ã¦ã„ã¾ã™ã€‚<br>
            å¤§å­¦é™¢ã¸ã®é€²å­¦ç‡ã‚‚é«˜ãã€é«˜åº¦ãªå°‚é–€æ€§ã‚’æ´»ã‹ã—ã¦ç ”ç©¶é–‹ç™ºè·ã«å°±ãå­¦ç”ŸãŒå¤šã„ã®ãŒç‰¹å¾´ã§ã™ã€‚(AIè«‡)</p>

            <div class="stats-container">
                <h2>Our Alumni</h2>
                <div class="stats-grid">
                    <div class="stat-item">
                        <h3 id="stat-companies">0+</h3>
                        <p>å°±è·å…ˆä¼æ¥­æ•°</p>
                    </div>
                    <div class="stat-item">
                        <h3 id="stat-rate">100%</h3>
                        <p>é€²è·¯æ±ºå®šç‡</p>
                    </div>
                    <div class="stat-item">
                        <h3 id="stat-master">Wait...</h3>
                        <p>å¤§å­¦é™¢é€²å­¦ãƒ»ä¿®äº†</p>
                    </div>
                </div>
            </div>

            <div id="career-list-wrapper">
                <p style="text-align: center; color: #888;">Loading data...</p>
            </div>

        </div>
    </section>
    
    <div id="footer-placeholder"></div>

    <script src="../../include.js"></script>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            loadComponent('header-placeholder', '../header_students.html');
            loadComponent('footer-placeholder', '../../footer.html');
            
            // CSVèª­ã¿è¾¼ã¿é–‹å§‹
            loadCareerData();
        });

        async function loadCareerData() {
            try {
                // CSVãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹ (é©å®œå¤‰æ›´ã—ã¦ãã ã•ã„)
                const response = await fetch('../../csv/career_data.csv?v=' + new Date().getTime());
                if (!response.ok) throw new Error("CSV file not found");
                const text = await response.text();

                const rows = text.trim().split('\n').slice(1);
                const wrapper = document.getElementById('career-list-wrapper');
                wrapper.innerHTML = '';

                // ãƒ‡ãƒ¼ã‚¿ã‚’æ ¼ç´ã™ã‚‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ (æ¥­ç•Œã”ã¨ã«é…åˆ—ã‚’ä½œã‚‹)
                const industryMap = {};
                let masterCount = 0;
                let totalCount = 0;

                rows.forEach(row => {
                    const cols = row.split(',');
                    if (cols.length < 3) return;

                    const year = cols[0].trim();
                    const company = cols[1].trim();
                    const industry = cols[2].trim();
                    const degree = cols[3] ? cols[3].trim() : "æœªå®š";

                    // çµ±è¨ˆç”¨ã‚«ã‚¦ãƒ³ãƒˆ
                    totalCount++;
                    if (degree.includes("ä¿®å£«") || degree.includes("é™¢") || industry === "é€²å­¦") {
                        masterCount++;
                    }

                    // æ¥­ç•Œã”ã¨ã«ã‚°ãƒ«ãƒ¼ãƒ—åŒ–
                    if (!industryMap[industry]) {
                        industryMap[industry] = [];
                    }
                    industryMap[industry].push({ year, company, degree });
                });

                // çµ±è¨ˆã®æ›´æ–°
                document.getElementById('stat-companies').innerText = Object.keys(industryMap).length * 3 + "+"; // é©å½“ãªæ¼”å‡º
                document.getElementById('stat-companies').innerText = totalCount;
                document.getElementById('stat-master').innerText = Math.round((masterCount / totalCount) * 100) + "%";


                // HTMLç”Ÿæˆ (æ¥­ç•Œã”ã¨ã«ãƒ«ãƒ¼ãƒ—)
                // æ¥­ç•Œåã®é †åºã‚’å›ºå®šã—ãŸã„å ´åˆã¯é…åˆ—ã§æŒ‡å®šã—ã¦ãã ã•ã„
                const sortedIndustries = Object.keys(industryMap).sort(); 

                sortedIndustries.forEach(industryName => {
                    const companies = industryMap[industryName];

                    // ã‚»ã‚¯ã‚·ãƒ§ãƒ³ä½œæˆ
                    const section = document.createElement('div');
                    section.className = 'industry-section';
                    
                    // ã‚¿ã‚¤ãƒˆãƒ«
                    const title = document.createElement('h2');
                    title.className = 'industry-title';
                    title.textContent = industryName;
                    section.appendChild(title);

                    // ã‚°ãƒªãƒƒãƒ‰
                    const grid = document.createElement('div');
                    grid.className = 'company-grid';

                    // ä¼æ¥­ã‚«ãƒ¼ãƒ‰ä½œæˆ
                    companies.forEach(item => {
                        const card = document.createElement('div');
                        card.className = 'company-card';

                        // å­¦ä½ã‚¿ã‚°ã®ã‚¯ãƒ©ã‚¹åˆ¤å®š
                        let degreeClass = 'degree-other';
                        let degreeLabel = item.degree;
                        if (item.degree.includes('ä¿®å£«') || item.degree.includes('åšå£«')) {
                            degreeClass = 'degree-master';
                            degreeLabel = 'Master';
                        } else if (item.degree.includes('å­¦éƒ¨')) {
                            degreeClass = 'degree-bachelor';
                            degreeLabel = 'Bachelor';
                        }

                        card.innerHTML = `
                            <div class="company-name">${item.company}</div>
                            <div class="card-footer">
                                <div class="grad-year">ğŸ“… ${item.year}å¹´åº¦</div>
                                <span class="degree-tag ${degreeClass}">${degreeLabel}</span>
                            </div>
                        `;
                        grid.appendChild(card);
                    });

                    section.appendChild(grid);
                    wrapper.appendChild(section);
                });

            } catch (error) {
                console.error("Career Data Error:", error);
                document.getElementById('career-list-wrapper').innerHTML = 
                    '<p style="text-align:center;">ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸã€‚</p>';
            }
        }
    </script>
</body>
</html>